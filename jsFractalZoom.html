<!DOCTYPE html>
<!--
	Fractal zoomer written in javascript
	https://github.com/xyzzy/jsFractalZoom

	Copyright 2018 https://github.com/xyzzy

	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU Affero General Public License as published
	by the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU Affero General Public License for more details.

	You should have received a copy of the GNU Affero General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<html lang="en">
<head>
	<title>jsFractalZoom</title>
	<meta charset="UTF-8"/>
	<link rel=stylesheet href="jsFractalZoom.css">
	<script type="text/javascript" src="aria.js"></script>
	<script type="text/javascript" src="formula.js"></script>
	<script type="text/javascript" src="zoomer.js"></script>
	<script type="text/javascript" src="jsFractalZoom.js"></script>
</head>
<body>
<canvas
	id="idZoomer"
	class="pane"
	tabindex="0"
	role="region"
	aria-live="off">
</canvas>
<div id="idAutopilot"></div>
	<div id="top" class="pane">
		<h1>jsFractalZoom <span id="idStatusTitle"></span></h1>
		<span id="WxH"></span>
		<span id="idStatusPosition"></span><br>
		<span id="idStatusLoad"></span>
		<span id="idStatusRect"></span>
	</div>
		<div id="nav" class="pane" aria-controls="main">

			<div class="navRow navButton">
				<div id="idPowerButton"
				     class="button"
				     tabindex="0"
				     role="button"
				     aria-pressed="false">
					Power

					<div class="light"></div>
				</div>
				<span class="navCaption">[Q]</span>

				<div id="idAutoPilotButton"
				     class="button"
				     tabindex="0"
				     role="button"
				     aria-pressed="false">
					Autopilot

					<div class="light"></div>
				</div>
				<span class="navCaption">[A]</span>

				<div id="idHomeButton"
				     class="button"
				     tabindex="0"
				     role="button">
					Home
				</div>
				<span class="navCaption">[HOME]</span>
			</div>

			<div class="navSeparator">
				<div class="navSepLeft">
					<div class="navLine"></div>
				</div>
				<div class="navSepName"><strong>Algorithm</strong></div>
				<div class="navSepRight">
					<div class="navLine"></div>
				</div>
			</div>

			<div id="idFormula" class="navRow navListbox">
				<div id="idFormulaLabel" class="navLabel">Formula</div>
				<div id="idFormulaLeft" class="navLeft"></div>
				<div id="idFormulaValue" class="navValue">
					<div id="idFormulaButton"
					     class="button"
					     tabindex="0"
					     role="button"
					     aria-haspopup="listbox"
					     aria-labelledby="idFormulaLabel">
					</div>
					<ul id="idFormulaList"
					    class="hidden"
					    tabindex="-1"
					    role="listbox"
					    aria-labelledby="idFormulaLabel">
						<li id="formula_0" role="option">mandelbrot</li>
						<li id="formula_1" role="option">mandelbrot^3</li>
						<li id="formula_2" role="option">mandelbrot^4</li>
						<li id="formula_3" role="option">mandelbrot^5</li>
						<li id="formula_4" role="option">mandelbrot^6</li>
						<li id="formula_5" role="option">octal</li>
						<li id="formula_6" role="option">newton</li>
						<li id="formula_7" role="option">barnsley1</li>
						<li id="formula_8" role="option">barnsley2</li>
						<li id="formula_9" role="option">phoenix</li>
						<li id="formula_10" role="option">magnet1</li>
						<li id="formula_11" role="option">magnet2</li>
					</ul>
				</div>
				<div id="idFormulaRight" class="navRight"><span class="navCaption">[F]</span></div>
			</div>

			<div id="idIncolour" class="navRow navListbox">
				<div id="idIncolourLabel" class="navLabel">Incolour</div>
				<div id="idIncolourLeft" class="navLeft"></div>
				<div id="idIncolourValue" class="navValue">
					<div id="idIncolourButton"
					     class="button"
					     tabindex="0"
					     role="button"
					     aria-haspopup="listbox"
					     aria-labelledby="idIncolourLabel">
					</div>
					<ul id="idIncolourList"
					    class="hidden"
					    tabindex="-1"
					    role="listbox"
					    aria-labelledby="idIncolourLabel">
						<li id="incolour_0" role="option">maxiter</li>
						<li id="incolour_1" role="option">zmag</li>
						<li id="incolour_2" role="option">decomposition-like</li>
						<li id="incolour_3" role="option">real/imag</li>
						<li id="incolour_4" role="option">mag*cos(real^2)</li>
						<li id="incolour_5" role="option">sin(real^2-imag^2)</li>
						<li id="incolour_6" role="option">atan(real*imag*creal*cimag)</li>
						<li id="incolour_7" role="option">squares</li>
					</ul>
				</div>
				<div id="idIncolourRight" class="navRight"><span class="navCaption">[I]</span></div>
			</div>

			<div id="idOutcolour" class="navRow navListbox">
				<div id="idOutcolourLabel" class="navLabel">Outcolour</div>
				<div id="idOutcolourLeft" class="navLeft"></div>
				<div id="idOutcolourValue" class="navValue">
					<div id="idOutcolourButton"
					     class="button"
					     tabindex="0"
					     role="button"
					     aria-haspopup="listbox"
					     aria-labelledby="idOutcolourLabel">
					</div>
					<ul id="idOutcolourList"
					    class="hidden"
					    tabindex="-1"
					    role="listbox"
					    aria-labelledby="idOutcolourLabel">
						<li id="outcolour_0" role="option">iter</li>
						<li id="outcolour_1" role="option">iter+real</li>
						<li id="outcolour_2" role="option">iter+imag</li>
						<li id="outcolour_3" role="option">iter+real/imag</li>
						<li id="outcolour_4" role="option">iter+real+imag+real/imag</li>
						<li id="outcolour_5" role="option">binary decomposition</li>
						<li id="outcolour_6" role="option">biomorphs</li>
						<li id="outcolour_7" role="option">potential</li>
						<li id="outcolour_8" role="option">color decomposition</li>
					</ul>
				</div>
				<div id="idOutcolourRight" class="navRight"><span class="navCaption">[O]</span></div>
			</div>

			<div id="idPlane" class="navRow navListbox">
				<div id="idPlaneLabel" class="navLabel">Plane</div>
				<div id="idPlaneLeft" class="navLeft"></div>
				<div id="idPlaneValue" class="navValue">
					<div id="idPlaneButton"
					     class="button"
					     tabindex="0"
					     role="button"
					     aria-haspopup="listbox"
					     aria-labelledby="idPlaneLabel">
					</div>
					<ul id="idPlaneList"
					    class="hidden"
					    tabindex="-1"
					    role="listbox"
					    aria-labelledby="idPlaneLabel">
						<li id="plane_0" role="option">mu</li>
						<li id="plane_1" role="option">1/mu</li>
						<li id="plane_2" role="option">1/(mu+0.25)</li>
						<li id="plane_3" role="option">lambda</li>
						<li id="plane_4" role="option">1/lambda</li>
						<li id="plane_5" role="option">1/(lambda-1)</li>
						<li id="plane_6" role="option">1/(mu-1.40115)</li>
					</ul>
				</div>
				<div id="idPlaneRight" class="navRight"><span class="navCaption">[P]</span></div>
			</div>

			<div class="navSeparator">
				<div class="navSepLeft">
					<div class="navLine"></div>
				</div>
				<div class="navSepName"><strong>Animation</strong></div>
				<div class="navSepRight">
					<div class="navLine"></div>
				</div>
			</div>

			<div id="idZoomSpeed" class="navRow navSlider">
				<div id="idZoomSpeedLabel" class="navLabel">Speed</div>
				<div id="idZoomSpeedLeft" class="navLeft"></div>
				<div id="idZoomSpeedValue" class="navValue">
					<div id="idZoomSpeedRail" class="rail">
						<div id="idZoomSpeedThumb"
						     role="slider"
						     tabindex="0"
						     class="thumb"
						     aria-labelledby="idZoomSpeedLabel">
						</div>
					</div>
				</div>
				<div id="idZoomSpeedRight" class="navRight"><span class="navCaption">[UP/DOWN]</span></div>
			</div>

			<div id="idRotate" class="navRow navSlider">
				<div id="idRotateLabel" class="navLabel">Rotate</div>
				<div id="idRotateLeft" class="navLeft"></div>
				<div id="idRotateValue" class="navValue">
					<div id="idRotateRail" class="rail">
						<div id="idRotateThumb"
						     role="slider"
						     tabindex="0"
						     class="thumb"
						     aria-labelledby="idRotateLabel">
						</div>
					</div>
				</div>
				<div id="idRotateRight" class="navRight"><span class="navCaption">[PAGEUP/PAGEDN]</span></div>
			</div>

			<div class="navSeparator">
				<div class="navSepLeft">
					<div class="navLine"></div>
				</div>
				<div class="navSepName"><strong>Colours</strong></div>
				<div class="navSepRight">
					<div class="navLine"></div>
				</div>
			</div>

			<div id="idPaletteSpeed" class="navRow navSlider">
				<div id="idPaletteSpeedLabel" class="navLabel">Cycle speed</div>
				<div id="idPaletteSpeedLeft" class="navLeft"></div>
				<div id="idPaletteSpeedValue" class="navValue">
					<div id="idPaletteSpeedRail" class="rail">
						<div id="idPaletteSpeedThumb"
						     role="slider"
						     tabindex="0"
						     class="thumb"
						     aria-labelledby="idPaletteSpeedLabel">
						</div>
					</div>
				</div>
				<div id="idPaletteSpeedRight" class="navRight"><span class="navCaption">[]</span></div>
			</div>

			<div id="idPalette" class="navRow navButton">
				<div id="idPaletteLabel" class="navLabel">Palette</div>
				<div id="idPaletteLeft" class="navLeft"></div>
				<div id="idPaletteValue" class="navValue">
					<div role="radiogroup"
					     aria-labelledby="idPaletteLabel"
					     id="idPaletteGroup">

						<div id="idRandomPaletteButton"
						     class="button"
						     tabindex="-1"
						     role="radio"
						     aria-checked="true">
							Random
							<div class="light"></div>
						</div>
						<span class="navCaption">[R]</span>

						<div id="idDefaultPaletteButton"
						     class="button"
						     tabindex="0"
						     role="radio"
						     aria-checked="false">
							Default
							<div class="light"></div>
						</div>
						<span class="navCaption">[D]</span>

					</div>
				</div>
				<div id="idPaletteRight" class="navRight"></div>
			</div>

			<div class="navSeparator">
				<div class="navSepLeft">
					<div class="navLine"></div>
				</div>
				<div class="navSepName"><strong>Performance</strong></div>
				<div class="navSepRight">
					<div class="navLine"></div>
				</div>
			</div>

			<div id="idDepth" class="navRow navSlider">
				<div id="idDepthLabel" class="navLabel">Depth</div>
				<div id="idDepthLeft" class="navLeft"></div>
				<div id="idDepthValue" class="navValue">
					<div id="idDepthRail" class="rail">
						<div id="idDepthThumb"
						     role="slider"
						     tabindex="0"
						     class="thumb"
						     aria-labelledby="idDepthLabel">
						</div>
					</div>
				</div>
				<div id="idDepthRight" class="navRight"><span class="navCaption">[]</span></div>
			</div>

			<div id="idFramerate" class="navRow navSlider">
				<div id="idFramerateLabel" class="navLabel">Framerate</div>
				<div id="idFramerateLeft" class="navLeft"></div>
				<div id="idFramerateValue" class="navValue">
					<div id="idFramerateRail" class="rail">
						<div id="idFramerateThumb"
						     role="slider"
						     tabindex="0"
						     class="thumb"
						     aria-labelledby="idFramerateLabel">
						</div>
					</div>
				</div>
				<div id="idFramerateRight" class="navRight"><span class="navCaption">[]</span></div>
			</div>

	<div id="idProjectPage">
		mouse-left: zoom in<br/>
		mouse-right: zoom out<br/>
		mouse-wheel: drag<br/>
		<br/>
		Visit <a href="https://www.rockingship.net/jsFractalZoom" >jsFractalZoom</a> project page
		</div>
	</div>

<script type="text/javascript">

	/*
	 * attack the situation that whitespace between tags upsets layout
	 * https://blog.nightly.mozilla.org/2016/10/17/devtools-now-display-white-space-text-nodes-in-the-dom-inspector
	 */
	function cleanNode(node) {
		var child;
		for (var i = node.childNodes.length; i--;) {
			child = node.childNodes[i];
			// delete whitespace-only text nodes
			if (child.nodeType === 3 && !/\S/.test(child.nodeValue)) {
				node.removeChild(child);
			} else {
				cleanNode(child);
			}
		}
	}

	window.addEventListener('load', function () {
		// remove whitespace-only text nodes
		cleanNode(document.body);

		// setup and link top-level components
		Config(); // setup initial static values
		Formula(); // setup initial static values
		window.palette = new Palette();
		window.gui = new GUI(window.config);

		var domZoomer = window.gui.domZoomer;
		domZoomer.width = domZoomer.clientWidth;
		domZoomer.height = domZoomer.clientHeight;

		// initial focus main view
		window.gui.domZoomer.focus();
		// press power button
		window.gui.power.buttonDown(); // push
		window.gui.power.buttonUp(); // and release
	});
</script>
</body>
</html>
